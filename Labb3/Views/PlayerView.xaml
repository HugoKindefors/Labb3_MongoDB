<UserControl x:Class="Labb3.Views.PlayerView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:local="clr-namespace:Labb3.Views"
             mc:Ignorable="d" 
             d:DesignHeight="450" d:DesignWidth="800">
    <UserControl.DataContext>
        <Binding RelativeSource="{RelativeSource AncestorType=Window}" Path="DataContext"/>
    </UserControl.DataContext>
    <Grid>
        
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <Label
            HorizontalAlignment="Right"
            VerticalAlignment="Top"
            FontSize="72"
            FontWeight="Bold"
            Foreground="Black"
            Margin="15"
            Grid.Row="0"
            Visibility="{Binding PlayerViewModel.IsPlaying, Converter={StaticResource BooleanToVisibilityConverter}}"
            Content="{Binding PlayerViewModel.RemainingSeconds}"
        />

        <StackPanel
            HorizontalAlignment="Center"
            VerticalAlignment="Center"
            Grid.Row="1"
        >
            <StackPanel.Style>
                <Style TargetType="StackPanel">
                    <Style.Triggers>
                        <DataTrigger Binding="{Binding PlayerViewModel.IsQuizFinished}" Value="True">
                            <Setter Property="Visibility" Value="Collapsed"/>
                        </DataTrigger>
                    </Style.Triggers>
                </Style>
            </StackPanel.Style>
            <Button
                Content="Start Quiz"
                Command="{Binding PlayerViewModel.StartCommand}"
                FontSize="24"
                Padding="20,10"
                Margin="0,0,0,20"
            >
                <Button.Style>
                    <Style TargetType="Button">
                        <Setter Property="Visibility" Value="Visible"/>
                        <Style.Triggers>
                            <DataTrigger Binding="{Binding PlayerViewModel.IsPlaying}" Value="True">
                                <Setter Property="Visibility" Value="Collapsed"/>
                            </DataTrigger>
                            <DataTrigger Binding="{Binding PlayerViewModel.IsQuizFinished}" Value="True">
                                <Setter Property="Visibility" Value="Collapsed"/>
                            </DataTrigger>
                        </Style.Triggers>
                    </Style>
                </Button.Style>
            </Button>

            <Label
                FontSize="30"
                FontWeight="Bold"
                HorizontalAlignment="Center"
                HorizontalContentAlignment="Center"
                VerticalContentAlignment="Center"
                Margin="20,0,20,10"
            >
                <Label.Content>
                    <TextBlock 
                        Text="{Binding PlayerViewModel.CurrentQuery}" 
                        TextWrapping="Wrap"
                        TextAlignment="Center"
                    />
                </Label.Content>
                <Label.Style>
                    <Style TargetType="Label">
                        <Setter Property="Visibility" Value="Collapsed"/>
                        <Style.Triggers>
                            <DataTrigger Binding="{Binding PlayerViewModel.IsPlaying}" Value="True">
                                <Setter Property="Visibility" Value="Visible"/>
                            </DataTrigger>
                            <DataTrigger Binding="{Binding PlayerViewModel.IsQuizFinished}" Value="True">
                                <Setter Property="Visibility" Value="Collapsed"/>
                            </DataTrigger>
                        </Style.Triggers>
                    </Style>
                </Label.Style>
            </Label>

            <Label
                FontSize="18"
                HorizontalAlignment="Center"
                Margin="0,0,0,25"
            >
                <Label.Style>
                    <Style TargetType="Label">
                        <Setter Property="Visibility" Value="Collapsed"/>
                        <Style.Triggers>
                            <DataTrigger Binding="{Binding PlayerViewModel.IsPlaying}" Value="True">
                                <Setter Property="Visibility" Value="Visible"/>
                            </DataTrigger>
                            <DataTrigger Binding="{Binding PlayerViewModel.IsQuizFinished}" Value="True">
                                <Setter Property="Visibility" Value="Collapsed"/>
                            </DataTrigger>
                        </Style.Triggers>
                    </Style>
                </Label.Style>
                <Label.Content>
                    <MultiBinding Converter="{StaticResource MultiValueConverter}" ConverterParameter="Fråga {0} av {1}">
                        <Binding Path="PlayerViewModel.CurrentQuestionNumber"/>
                        <Binding Path="PlayerViewModel.TotalQuestions"/>
                    </MultiBinding>
                </Label.Content>
            </Label>

            <Grid Margin="0 0 0 0" Width="600" HorizontalAlignment="Stretch">
                <Grid.Style>
                    <Style TargetType="Grid">
                        <Setter Property="Visibility" Value="Collapsed"/>
                        <Style.Triggers>
                            <DataTrigger Binding="{Binding PlayerViewModel.IsPlaying}" Value="True">
                                <Setter Property="Visibility" Value="Visible"/>
                            </DataTrigger>
                            <DataTrigger Binding="{Binding PlayerViewModel.IsQuizFinished}" Value="True">
                                <Setter Property="Visibility" Value="Collapsed"/>
                            </DataTrigger>
                        </Style.Triggers>
                    </Style>
                </Grid.Style>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>

                <Border
                    Grid.Row="0"
                    Grid.Column="0"
                    Margin="10"
                    BorderBrush="Transparent"
                    BorderThickness="0"
                >
                    <Border.Style>
                        <Style TargetType="Border">
                            <Style.Triggers>
                                <MultiDataTrigger>
                                    <MultiDataTrigger.Conditions>
                                        <Condition Binding="{Binding PlayerViewModel.IsAnswerRevealed}" Value="True"/>
                                        <Condition Binding="{Binding PlayerViewModel.CurrentCorrectIndex}" Value="0"/>
                                    </MultiDataTrigger.Conditions>
                                    <Setter Property="BorderBrush" Value="Green"/>
                                    <Setter Property="BorderThickness" Value="5"/>
                                </MultiDataTrigger>
                                <DataTrigger Value="True">
                                    <DataTrigger.Binding>
                                        <MultiBinding Converter="{StaticResource IsWrongAnswerConverter}" ConverterParameter="0">
                                            <Binding Path="PlayerViewModel.IsAnswerRevealed"/>
                                            <Binding Path="PlayerViewModel.SelectedAnswerIndex"/>
                                            <Binding Path="PlayerViewModel.CurrentCorrectIndex"/>
                                        </MultiBinding>
                                    </DataTrigger.Binding>
                                    <Setter Property="BorderBrush" Value="Red"/>
                                    <Setter Property="BorderThickness" Value="5"/>
                                </DataTrigger>
                            </Style.Triggers>
                        </Style>
                    </Border.Style>
                    <Button
                        FontSize="20"
                        Height="80"
                        HorizontalAlignment="Stretch"
                        Command="{Binding PlayerViewModel.AnswerCommand}"
                        CommandParameter="0"
                        HorizontalContentAlignment="Center"
                        VerticalContentAlignment="Center"
                        Background="#E0E0E0"
                    >
                        <Button.Style>
                            <Style TargetType="Button">
                                <Setter Property="IsEnabled" Value="True"/>
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding PlayerViewModel.IsAnswerRevealed}" Value="True">
                                        <Setter Property="IsEnabled" Value="False"/>
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </Button.Style>
                        <TextBlock 
                            Text="{Binding PlayerViewModel.CurrentAnswers[0]}" 
                            TextWrapping="Wrap" 
                            TextAlignment="Center"
                            HorizontalAlignment="Center"
                            VerticalAlignment="Center"
                        >
                            <TextBlock.Style>
                                <Style TargetType="TextBlock">
                                    <Style.Triggers>
                                        <MultiDataTrigger>
                                            <MultiDataTrigger.Conditions>
                                                <Condition Binding="{Binding PlayerViewModel.IsAnswerRevealed}" Value="True"/>
                                                <Condition Binding="{Binding PlayerViewModel.CurrentCorrectIndex}" Value="0"/>
                                            </MultiDataTrigger.Conditions>
                                            <Setter Property="Foreground" Value="Green"/>
                                            <Setter Property="FontWeight" Value="Bold"/>
                                        </MultiDataTrigger>
                                        <DataTrigger Value="True">
                                            <DataTrigger.Binding>
                                                <MultiBinding Converter="{StaticResource IsWrongAnswerConverter}" ConverterParameter="0">
                                                    <Binding Path="PlayerViewModel.IsAnswerRevealed"/>
                                                    <Binding Path="PlayerViewModel.SelectedAnswerIndex"/>
                                                    <Binding Path="PlayerViewModel.CurrentCorrectIndex"/>
                                                </MultiBinding>
                                            </DataTrigger.Binding>
                                            <Setter Property="Foreground" Value="Red"/>
                                            <Setter Property="FontWeight" Value="Bold"/>
                                        </DataTrigger>
                                    </Style.Triggers>
                                </Style>
                            </TextBlock.Style>
                        </TextBlock>
                    </Button>
                </Border>

                <Border
                    Grid.Row="0"
                    Grid.Column="1"
                    Margin="10"
                    BorderBrush="Transparent"
                    BorderThickness="0"
                >
                    <Border.Style>
                        <Style TargetType="Border">
                            <Style.Triggers>
                                <MultiDataTrigger>
                                    <MultiDataTrigger.Conditions>
                                        <Condition Binding="{Binding PlayerViewModel.IsAnswerRevealed}" Value="True"/>
                                        <Condition Binding="{Binding PlayerViewModel.CurrentCorrectIndex}" Value="1"/>
                                    </MultiDataTrigger.Conditions>
                                    <Setter Property="BorderBrush" Value="Green"/>
                                    <Setter Property="BorderThickness" Value="5"/>
                                </MultiDataTrigger>
                                <DataTrigger Value="True">
                                    <DataTrigger.Binding>
                                        <MultiBinding Converter="{StaticResource IsWrongAnswerConverter}" ConverterParameter="1">
                                            <Binding Path="PlayerViewModel.IsAnswerRevealed"/>
                                            <Binding Path="PlayerViewModel.SelectedAnswerIndex"/>
                                            <Binding Path="PlayerViewModel.CurrentCorrectIndex"/>
                                        </MultiBinding>
                                    </DataTrigger.Binding>
                                    <Setter Property="BorderBrush" Value="Red"/>
                                    <Setter Property="BorderThickness" Value="5"/>
                                </DataTrigger>
                            </Style.Triggers>
                        </Style>
                    </Border.Style>
                    <Button
                        FontSize="20"
                        Height="80"
                        HorizontalAlignment="Stretch"
                        Command="{Binding PlayerViewModel.AnswerCommand}"
                        CommandParameter="1"
                        HorizontalContentAlignment="Center"
                        VerticalContentAlignment="Center"
                        Background="#E0E0E0"
                    >
                        <Button.Style>
                            <Style TargetType="Button">
                                <Setter Property="IsEnabled" Value="True"/>
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding PlayerViewModel.IsAnswerRevealed}" Value="True">
                                        <Setter Property="IsEnabled" Value="False"/>
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </Button.Style>
                        <TextBlock 
                            Text="{Binding PlayerViewModel.CurrentAnswers[1]}" 
                            TextWrapping="Wrap" 
                            TextAlignment="Center"
                            HorizontalAlignment="Center"
                            VerticalAlignment="Center"
                        >
                            <TextBlock.Style>
                                <Style TargetType="TextBlock">
                                    <Style.Triggers>
                                        <MultiDataTrigger>
                                            <MultiDataTrigger.Conditions>
                                                <Condition Binding="{Binding PlayerViewModel.IsAnswerRevealed}" Value="True"/>
                                                <Condition Binding="{Binding PlayerViewModel.CurrentCorrectIndex}" Value="1"/>
                                            </MultiDataTrigger.Conditions>
                                            <Setter Property="Foreground" Value="Green"/>
                                            <Setter Property="FontWeight" Value="Bold"/>
                                        </MultiDataTrigger>
                                        <DataTrigger Value="True">
                                            <DataTrigger.Binding>
                                                <MultiBinding Converter="{StaticResource IsWrongAnswerConverter}" ConverterParameter="1">
                                                    <Binding Path="PlayerViewModel.IsAnswerRevealed"/>
                                                    <Binding Path="PlayerViewModel.SelectedAnswerIndex"/>
                                                    <Binding Path="PlayerViewModel.CurrentCorrectIndex"/>
                                                </MultiBinding>
                                            </DataTrigger.Binding>
                                            <Setter Property="Foreground" Value="Red"/>
                                            <Setter Property="FontWeight" Value="Bold"/>
                                        </DataTrigger>
                                    </Style.Triggers>
                                </Style>
                            </TextBlock.Style>
                        </TextBlock>
                    </Button>
                </Border>

                <Border
                    Grid.Row="1"
                    Grid.Column="0"
                    Margin="10"
                    BorderBrush="Transparent"
                    BorderThickness="0"
                >
                    <Border.Style>
                        <Style TargetType="Border">
                            <Style.Triggers>
                                <MultiDataTrigger>
                                    <MultiDataTrigger.Conditions>
                                        <Condition Binding="{Binding PlayerViewModel.IsAnswerRevealed}" Value="True"/>
                                        <Condition Binding="{Binding PlayerViewModel.CurrentCorrectIndex}" Value="2"/>
                                    </MultiDataTrigger.Conditions>
                                    <Setter Property="BorderBrush" Value="Green"/>
                                    <Setter Property="BorderThickness" Value="5"/>
                                </MultiDataTrigger>
                                <DataTrigger Value="True">
                                    <DataTrigger.Binding>
                                        <MultiBinding Converter="{StaticResource IsWrongAnswerConverter}" ConverterParameter="2">
                                            <Binding Path="PlayerViewModel.IsAnswerRevealed"/>
                                            <Binding Path="PlayerViewModel.SelectedAnswerIndex"/>
                                            <Binding Path="PlayerViewModel.CurrentCorrectIndex"/>
                                        </MultiBinding>
                                    </DataTrigger.Binding>
                                    <Setter Property="BorderBrush" Value="Red"/>
                                    <Setter Property="BorderThickness" Value="5"/>
                                </DataTrigger>
                            </Style.Triggers>
                        </Style>
                    </Border.Style>
                    <Button
                        FontSize="20"
                        Height="80"
                        HorizontalAlignment="Stretch"
                        Command="{Binding PlayerViewModel.AnswerCommand}"
                        CommandParameter="2"
                        HorizontalContentAlignment="Center"
                        VerticalContentAlignment="Center"
                        Background="#E0E0E0"
                    >
                        <Button.Style>
                            <Style TargetType="Button">
                                <Setter Property="IsEnabled" Value="True"/>
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding PlayerViewModel.IsAnswerRevealed}" Value="True">
                                        <Setter Property="IsEnabled" Value="False"/>
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </Button.Style>
                        <TextBlock 
                            Text="{Binding PlayerViewModel.CurrentAnswers[2]}" 
                            TextWrapping="Wrap" 
                            TextAlignment="Center"
                            HorizontalAlignment="Center"
                            VerticalAlignment="Center"
                        >
                            <TextBlock.Style>
                                <Style TargetType="TextBlock">
                                    <Style.Triggers>
                                        <MultiDataTrigger>
                                            <MultiDataTrigger.Conditions>
                                                <Condition Binding="{Binding PlayerViewModel.IsAnswerRevealed}" Value="True"/>
                                                <Condition Binding="{Binding PlayerViewModel.CurrentCorrectIndex}" Value="2"/>
                                            </MultiDataTrigger.Conditions>
                                            <Setter Property="Foreground" Value="Green"/>
                                            <Setter Property="FontWeight" Value="Bold"/>
                                        </MultiDataTrigger>
                                        <DataTrigger Value="True">
                                            <DataTrigger.Binding>
                                                <MultiBinding Converter="{StaticResource IsWrongAnswerConverter}" ConverterParameter="2">
                                                    <Binding Path="PlayerViewModel.IsAnswerRevealed"/>
                                                    <Binding Path="PlayerViewModel.SelectedAnswerIndex"/>
                                                    <Binding Path="PlayerViewModel.CurrentCorrectIndex"/>
                                                </MultiBinding>
                                            </DataTrigger.Binding>
                                            <Setter Property="Foreground" Value="Red"/>
                                            <Setter Property="FontWeight" Value="Bold"/>
                                        </DataTrigger>
                                    </Style.Triggers>
                                </Style>
                            </TextBlock.Style>
                        </TextBlock>
                    </Button>
                </Border>

                <Border
                    Grid.Row="1"
                    Grid.Column="1"
                    Margin="10"
                    BorderBrush="Transparent"
                    BorderThickness="0"
                >
                    <Border.Style>
                        <Style TargetType="Border">
                            <Style.Triggers>
                                <MultiDataTrigger>
                                    <MultiDataTrigger.Conditions>
                                        <Condition Binding="{Binding PlayerViewModel.IsAnswerRevealed}" Value="True"/>
                                        <Condition Binding="{Binding PlayerViewModel.CurrentCorrectIndex}" Value="3"/>
                                    </MultiDataTrigger.Conditions>
                                    <Setter Property="BorderBrush" Value="Green"/>
                                    <Setter Property="BorderThickness" Value="5"/>
                                </MultiDataTrigger>
                                <DataTrigger Value="True">
                                    <DataTrigger.Binding>
                                        <MultiBinding Converter="{StaticResource IsWrongAnswerConverter}" ConverterParameter="3">
                                            <Binding Path="PlayerViewModel.IsAnswerRevealed"/>
                                            <Binding Path="PlayerViewModel.SelectedAnswerIndex"/>
                                            <Binding Path="PlayerViewModel.CurrentCorrectIndex"/>
                                        </MultiBinding>
                                    </DataTrigger.Binding>
                                    <Setter Property="BorderBrush" Value="Red"/>
                                    <Setter Property="BorderThickness" Value="5"/>
                                </DataTrigger>
                            </Style.Triggers>
                        </Style>
                    </Border.Style>
                    <Button
                        FontSize="20"
                        Height="80"
                        HorizontalAlignment="Stretch"
                        Command="{Binding PlayerViewModel.AnswerCommand}"
                        CommandParameter="3"
                        HorizontalContentAlignment="Center"
                        VerticalContentAlignment="Center"
                        Background="#E0E0E0"
                    >
                        <Button.Style>
                            <Style TargetType="Button">
                                <Setter Property="IsEnabled" Value="True"/>
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding PlayerViewModel.IsAnswerRevealed}" Value="True">
                                        <Setter Property="IsEnabled" Value="False"/>
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </Button.Style>
                        <TextBlock 
                            Text="{Binding PlayerViewModel.CurrentAnswers[3]}" 
                            TextWrapping="Wrap" 
                            TextAlignment="Center"
                            HorizontalAlignment="Center"
                            VerticalAlignment="Center"
                        >
                            <TextBlock.Style>
                                <Style TargetType="TextBlock">
                                    <Style.Triggers>
                                        <MultiDataTrigger>
                                            <MultiDataTrigger.Conditions>
                                                <Condition Binding="{Binding PlayerViewModel.IsAnswerRevealed}" Value="True"/>
                                                <Condition Binding="{Binding PlayerViewModel.CurrentCorrectIndex}" Value="3"/>
                                            </MultiDataTrigger.Conditions>
                                            <Setter Property="Foreground" Value="Green"/>
                                            <Setter Property="FontWeight" Value="Bold"/>
                                        </MultiDataTrigger>
                                        <DataTrigger Value="True">
                                            <DataTrigger.Binding>
                                                <MultiBinding Converter="{StaticResource IsWrongAnswerConverter}" ConverterParameter="3">
                                                    <Binding Path="PlayerViewModel.IsAnswerRevealed"/>
                                                    <Binding Path="PlayerViewModel.SelectedAnswerIndex"/>
                                                    <Binding Path="PlayerViewModel.CurrentCorrectIndex"/>
                                                </MultiBinding>
                                            </DataTrigger.Binding>
                                            <Setter Property="Foreground" Value="Red"/>
                                            <Setter Property="FontWeight" Value="Bold"/>
                                        </DataTrigger>
                                    </Style.Triggers>
                                </Style>
                            </TextBlock.Style>
                        </TextBlock>
                    </Button>
                </Border>
            </Grid>

            <StackPanel
                HorizontalAlignment="Center"
                Margin="0,20,0,10"
                MinHeight="40"
            >
                <StackPanel.Style>
                    <Style TargetType="StackPanel">
                        <Setter Property="Visibility" Value="Hidden"/>
                        <Style.Triggers>
                            <DataTrigger Binding="{Binding PlayerViewModel.IsAnswerRevealed}" Value="True">
                                <Setter Property="Visibility" Value="Visible"/>
                            </DataTrigger>
                            <DataTrigger Binding="{Binding PlayerViewModel.IsQuizFinished}" Value="True">
                                <Setter Property="Visibility" Value="Hidden"/>
                            </DataTrigger>
                        </Style.Triggers>
                    </Style>
                </StackPanel.Style>
                <Label
                    FontSize="24"
                    FontWeight="Bold"
                    HorizontalAlignment="Center"
                >
                    <Label.Style>
                        <Style TargetType="Label">
                            <Setter Property="Content" Value="Correct!"/>
                            <Setter Property="Foreground" Value="Green"/>
                            <Style.Triggers>
                                <DataTrigger Binding="{Binding PlayerViewModel.LastAnswerCorrect}" Value="False">
                                    <Setter Property="Content" Value="Incorrect!"/>
                                    <Setter Property="Foreground" Value="Red"/>
                                </DataTrigger>
                            </Style.Triggers>
                        </Style>
                    </Label.Style>
                </Label>
            </StackPanel>

            <Button
                Content="Next"
                Command="{Binding PlayerViewModel.NextCommand}"
                FontSize="20"
                Padding="30,10"
                Margin="0,10,0,0"
                MinHeight="50"
            >
                <Button.Style>
                    <Style TargetType="Button">
                        <Setter Property="Visibility" Value="Hidden"/>
                        <Style.Triggers>
                            <DataTrigger Binding="{Binding PlayerViewModel.IsAnswerRevealed}" Value="True">
                                <Setter Property="Visibility" Value="Visible"/>
                            </DataTrigger>
                            <DataTrigger Binding="{Binding PlayerViewModel.IsQuizFinished}" Value="True">
                                <Setter Property="Visibility" Value="Hidden"/>
                            </DataTrigger>
                        </Style.Triggers>
                    </Style>
                </Button.Style>
            </Button>

        </StackPanel>

        <StackPanel
            HorizontalAlignment="Center"
            VerticalAlignment="Center"
            Grid.Row="1"
            Panel.ZIndex="10"
            Visibility="{Binding PlayerViewModel.IsQuizFinished, Converter={StaticResource BooleanToVisibilityConverter}}"
        >
            <Label
                Content="Quiz Finished!"
                FontSize="36"
                FontWeight="Bold"
                HorizontalAlignment="Center"
                Margin="0,0,0,20"
            />
            <Label
                FontSize="24"
                HorizontalAlignment="Center"
                Margin="0,0,0,30"
            >
                <Label.Content>
                    <MultiBinding Converter="{StaticResource MultiValueConverter}" ConverterParameter="Du fick {0} av {1} rätt">
                        <Binding Path="PlayerViewModel.CorrectAnswers"/>
                        <Binding Path="PlayerViewModel.TotalQuestions"/>
                    </MultiBinding>
                </Label.Content>
            </Label>
            <Button
                Content="Start New Quiz"
                Command="{Binding PlayerViewModel.RestartCommand}"
                FontSize="20"
                Padding="30,10"
                Margin="0,10,0,0"
            />
        </StackPanel>

    </Grid>

</UserControl>
